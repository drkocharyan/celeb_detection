# Celebrity Face Dataset

##  Описание проекта
Проект направлен на создание датасета лиц знаменитостей (актеров) с последующей оценкой качества эмбеддингов, полученных с помощью предобученных моделей распознавания лиц.

**Важно**: Подробное описание смотрите в файле README.ipynb (на гите файл не открывается, продублировал на яндекс диск https://disk.yandex.ru/d/pvSa1bp9X9oVZw)  нем все актуальное.  Данные также на яндекс диске https://disk.yandex.ru/d/pvSa1bp9X9oVZw

---

## 1️ Отбор знаменитостей
- Источник данных — **TMDB API** (`/movie/popular`, `/credits`, `/person/{id}`)  
- Критерии:
  - наличие фото (`profile_path`);
  - более **10 фильмов** в фильмографии;
  - исключены: японские актёры, adult-контент, дубликаты, black-list.  
- Результаты сохраняются в `C2ID_updated.json`.

---

## 2️ Сбор данных
- Для каждой страницы популярных фильмов собираются актёры и их изображения.
- Фотографии скачиваются в структуру:
```
result_data/
├── C2ID_updated.json
├── black_list.json
├── embeddings/
│   ├── Abella_Danger.npy
│   ├── Adam_Brody.npy
│   ├── Adam_Driver.npy
│   ├── Adria_Arjona.npy
├── embeddings_aug/
│   ├── Abella_Danger.npy
│   ├── Adam_Brody.npy
│   ├── Adam_Driver.npy
│   ├── Adria_Arjona.npy
└── imgs/
    ├── Abella_Danger/
    ├── Adam_Brody/
    ├── Adam_Driver/
    ├── Addison_Timlin/
    │   ├── 0.jpg
    │   ├── 1.jpg
    │   ├── 10.jpg
    │   ├── 11.jpg
    │   ├── 12.jpg
    │   ├── 13.jpg
    │   ├── 2.jpg
```
- Минимум **20 изображений** на актёра (рекомендуется ≥50).  
- Прогресс сохраняется каждые 2 страницы (`page.txt`).  
- данные в папке https://disk.yandex.ru/d/pvSa1bp9X9oVZw

---

## 3️ Обработка изображений
- **Детекция лиц:** `MTCNN (facenet-pytorch)`  
- берётся только первое найденное лицо.  
- **Эмбеддинги:** `InceptionResnetV1 (VGGFace2 pretrained)`  
- **Аугментация:** зеркальное отражение (flip).  
- Сохраняются только кропы и эмбеддинги:

---

## 4️ Используемые модели

| Этап | Модель | Причина выбора |
|------|---------|----------------|
| Детекция | MTCNN | высокая точность, стабильность на портретах |
| Эмбеддинги | InceptionResnetV1 | стандартная модель face recognition |
| Аугментация | Flip | повышает устойчивость и разнообразие данных |

---

## 5️ Метрики качества
- **Neighbor Purity** — средняя доля «правильных соседей» по косинусной метрике:
- оригинал ≈ **0.989**
- аугментация ≈ **0.989**
- средняя доля правильный соседей (с аугментацией) ≈ **0.996**
- **UMAP / t-SNE** — визуализация эмбеддингов показывает чёткие кластеры актёров.  

## 6 Какие проблемы и ограничения вы обнаружили
    -  на сайте учитывается аниме, так что актеры озвучку становятся проблемой, тк поиск выдает на них аниме персонажей, а не лица
    - здесь учитываются фильмы 18+, так что часть актеров звездны не консервативного формата
    - часть библотек для опозования лиц попросту устарела, так что пришлось мучаться с выбором модели для кропа лиц
    - проблем со множеством лиц не было, тк в основном фото портретные
    - в целом листание по фильмам и сбор актеров по ним имеет минус в том что со временем кол-во новых актером экспоенциально уменьшает и выходит на плато в 5-10 человек на 20 фильмов
    - на гпу обработка одной страницы (все включая) занимает порядка 3-5 минут, на цпу минут 10 
---

##  Итог
- Собрано ≈ **~600 актёров** с минимум 20 изображениями каждый. Можно сделать больше, нужно просто продолжить обкачку  
- Эмбеддинги чистые, кластеры разделены.   
- схожие внешне актёры, могут быть пробелмой, но при просмотре глазами не заметил такого;
- редкие случаи с несколькими лицами на фото, не внесли импакта, смог найти только 1 такой кейс;
- старые или неактуальные изображения, вопрос грима и возрастных ограничении, но судя по всему тоже не заафектило.

## Задел на грейд
 - есть базовая обкачка, которую можно дполнить за счет википедии
 - было бы круто собрать мини обзор на актера с помощью страниц википедии за счет ллм
 - у нас уже есть минимальное представление о лице человека в векторах, так что можно делать доп обкачку с интернета, но мы можнм получить недостаточное разнообразие
 - нужны ограничения на цензуру

---

